<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <script src="../node_modules/vue/dist/vue.min.js"></script>
  <link rel="stylesheet" href="../lib/bootstrap.css">
</head>

<body>
  <div class="app">




    <div class="panel panel-primary">
      <div class="panel-heading">
        <h3 class="panel-title">æ·»åŠ å“ç‰Œ</h3>
      </div>
      <div class="panel-body form-inline">
        <label>
          Id:
          <input type="text" class="form-control" v-model="id">
        </label>

        <label>
          Name:
          <input type="text" class="form-control" v-model="name" @keyup.enter="add">
          <input type="button" value="æ·»åŠ " class="btn btn-primary" @click="add()">
        </label>

        <label>
          ğŸ”æœç´¢åç§°å…³é”®å­—:
          <!-- âš ï¸æ³¨æ„ï¼šVueä¸­æ‰€æœ‰çš„æŒ‡ä»¤ï¼Œåœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œéƒ½ä»¥v-å¼€å¤´ -->
          <input type="text" class="form-control" v-model="keywords" id='search' v-focus v-color="'green'">
        </label>

        <!-- ä½¿ç”¨v-on ç»‘å®šäº‹ä»¶æ—¶ï¼Œæ·»åŠ æ‹¬å·ï¼Œç”¨äºä¼ å‚ -->
      </div>
    </div>


    <table class="table table-hover table-bordered table-striped">
      <thead>
        <tr>
          <th>Id</th>
          <th>Name</th>
          <th>ctime</th>
          <th>Operation</th>
        </tr>
      </thead>
      <tbody>
        <!-- ä¹‹å‰ï¼Œ v-forä¸­çš„æ•°æ®ï¼Œéƒ½æ˜¯ç›´æ¥ä»dataä¸Šçš„listä¸­ç›´æ¥æ¸²æŸ“è¿‡æ¥çš„ï¼ -->
        <!-- ç°åœ¨è‡ªå®šä¹‰äº†searchæ–¹æ³•ï¼ŒåŒæ—¶æŠŠ æœç´¢çš„å…³é”®å­—é€šè¿‡ä¼ å‚çš„å½¢å¼ï¼Œä¼ é€’ç»™äº†serchæ–¹æ³• -->
        <!-- åœ¨ search æ–¹æ³•å†…éƒ¨ï¼Œé€šè¿‡ æ‰§è¡Œ for å¾ªç¯ï¼ŒæŠŠæ‰€æœ‰ç¬¦åˆ æœç´¢å…³é”®å­—çš„æ•°æ®ï¼Œä¿å­˜åˆ° ä¸€ä¸ªæ–°çš„æ•°ç»„ä¸­
      è¿”å› -->
        <tr v-for="item in search(keywords)" :key="item.id ">
          <td>{{item.id}}</td>
          <td v-text="item.name"></td>
          <td>{{item.ctime | dateFormat("")}}</td>
          <td>
            <a href="#" @click.prevent="del(item.id)">åˆ é™¤</a>
          </td>
        </tr>
      </tbody>
    </table>

  </div>

  <div class="app2" v-color="'skyblue'" v-fontweight="700" v-fontsize="'30px'">
    {{dt | dateFormat}}
  </div>

  <script>
    // å…¨å±€çš„è¿‡æ»¤å™¨,è¿›è¡Œæ—¶é—´çš„æ ¼å¼åŒ–
    // æ‰€è°“çš„å…¨å±€è¿‡æ»¤å™¨ï¼Œå°±æ˜¯æ‰€æœ‰çš„VMå®ä¾‹éƒ½å…±äº«çš„ï¼
    Vue.filter('dateFormat', function (dateStr, pattern = ' ') {
      // æ ¹æ®ç»™å®šçš„æ—¶é—´å­—ç¬¦ä¸²,å¾—åˆ°ç‰¹å®šçš„æ—¶é—´
      const dt = new Date(dateStr);
      const y = dt.getFullYear();
      const m = dt.getMonth() + 1;
      const d = dt.getDate();
      // return ` ${y}-${m}-${d} `
      console.log(pattern);

      if (pattern.toLowerCase() === 'yyyy-mm-dd') {
        return ` ${y}-${m}-${d} `
      } else {
        const hh = dt.getHours();
        const mm = dt.getMinutes();
        const ss = dt.getSeconds();

      return ` ${y}-${m}-${d} ${hh}:${mm}:${ss} è¿™æ˜¯å…¨å±€çš„ä¹Ÿå°±æ˜¯Globçš„`

      }
    });


    // å®šä¹‰å…¨å±€æŒ‰é”®ä¿®é¥°ç¬¦
    Vue.config.keyCodes.f2 = 113;

    // ä½¿ç”¨ Vue.directive() å®šä¹‰å…¨å±€æŒ‡ä»¤
    // å…¶ä¸­ï¼šå‚æ•°1:æŒ‡ä»¤çš„åç§°ï¼Œâš ï¸æ³¨æ„ï¼šåœ¨å®šä¹‰çš„æ—¶å€™ï¼ŒæŒ‡ä»¤çš„åç§°å‰é¢ï¼Œä¸åŠ v-ï¼›
    // åœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œå¿…é¡»åœ¨æŒ‡ä»¤åç§°å‰ åŠ ä¸Š v-
    // å‚æ•°2ï¼š æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡èº«ä¸Šï¼Œæœ‰ä¸€äº›æŒ‡ä»¤ç›¸å…³çš„å‡½æ•°ï¼Œè¿™äº›å‡½æ•°å¯ä»¥åœ¨ç‰¹å®šçš„é˜¶æ®µï¼Œæ‰§è¡Œç›¸å…³çš„æ“ä½œã€‚
    Vue.directive('focus', {
      bind: function (el) { // æ¯å½“æŒ‡ä»¤ç»‘å®šåˆ°å…ƒç´ ä¸Šçš„æ—¶å€™ï¼Œä¼šç«‹å³æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œåªæ‰§è¡Œä¸€æ¬¡
        //  âš ï¸æ³¨æ„ï¼šåœ¨æ¯ä¸ª å‡½æ•°ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ°¸è¿œéƒ½æ˜¯elã€‚è¡¨ç¤º è¢«ç»‘å®šäº†æŒ‡ä»¤çš„é‚£ä¸ªå…ƒç´ ã€‚è¿™ä¸ªelå‚æ•°ã€‚æ˜¯ä¸€ä¸ªåŸç”ŸJSå¯¹è±¡
        //  åœ¨å…ƒç´ åˆšç»‘å®šäº†æŒ‡ä»¤ç¬¦æ—¶å€™ï¼Œè¿˜æ²¡æœ‰æ’å…¥åˆ°Domä¸­å»ï¼Œè¿™æ—¶å€™ï¼Œè°ƒç”¨focusæ–¹æ³•æ²¡æœ‰ä½œç”¨
        //  å› ä¸ºï¼Œä¸€ä¸ªå…ƒç´ ï¼Œåªæœ‰æ’å…¥åˆ°Domä¹‹åï¼Œæ‰èƒ½è·å–ç„¦ç‚¹ã€‚
      },
      inserted(el) { // å…ƒç´ æ’å…¥ Domä¸­çš„æ—¶å€™ï¼Œä¼šæ‰§è¡Œinsertedå‡½æ•°ï¼Œåªè§¦å‘ä¸€æ¬¡
        el.focus();
        // å’ŒJSè¡Œä¸ºæœ‰å…³çš„æ“ä½œï¼Œæœ€å¥½åœ¨insertedä¸­å»æ‰§è¡Œï¼Œé˜²æ­¢JSè¡Œä¸ºä¸ç”Ÿæ•ˆ
      },
      update: function (el) { // å½“VNodeæ›´æ–°çš„æ—¶å€™ï¼Œä¼šæ‰§è¡Œupdate ï¼Œå¯èƒ½ä¼šè§¦å‘å¤šæ¬¡

      }
    });

    // è‡ªå®šä¹‰ä¸€ä¸ª è®¾ç½®å­—ä½“é¢œè‰²çš„æŒ‡ä»¤
    Vue.directive('color', {
      // æ ·å¼ï¼Œåªè¦é€šè¿‡æŒ‡ä»¤ç»‘å®šç»™äº†å…ƒç´ ï¼Œä¸ç®¡è¿™ä¸ªå…ƒç´ æœ‰æ²¡æœ‰è¢«æ’å…¥åˆ°é¡µé¢ä¸­å»ï¼Œè¿™ä¸ªå…ƒç´ è‚¯å®šæœ‰äº†ä¸€ä¸ªå†…è”æ ·å¼ã€‚
      // å°†æ¥å…ƒç´ è‚¯å®šä¼šæ˜¾ç¤ºåˆ°é¡µé¢ä¸­ï¼Œè¿™æ—¶å€™ï¼Œæµè§ˆå™¨çš„æ¸²æŸ“å¼•æ“å¿…ç„¶ä¼šè§£ææ ·å¼ï¼Œåº”ç”¨ç»™è¿™ä¸ªå…ƒç´ 
      bind(el, binding) {
        el.style.color = binding.value;
        console.log(binding);
        // å’Œæ ·å¼ç›¸å…³çš„æ“ä½œï¼Œä¸€èˆ¬éƒ½å¯ä»¥åœ¨bindä¸­æ‰§è¡Œ
      },

    })

    // åˆ›å»º Vueå®ä¾‹,å¾—åˆ°ViewModel
    const vm = new Vue({
      el: ".app",
      data: {
        list: [
          { id: 1, name: 'åä¸º', ctime: new Date() },
          { id: 2, name: 'è‹¹æœğŸ', ctime: new Date() },
        ],
        id: '',
        name: '',
        keywords: '' //æœç´¢çš„å…³é”®å­—
      },
      methods: {
        add() {
          this.list.push({ id: this.id, name: this.name, ctime: new Date() });
          this.id = this.name = " ";
        },
        del(id) {
          // this.list.some((item, i) => {
          //   if (item.id == id) {
          //     this.list.splice(i,1);
          //     // åœ¨æ•°ç»„çš„someæ–¹æ³•ä¸­ï¼Œå¦‚æœreturn trueï¼Œ å°±ä¼šç«‹å³ç»ˆæ­¢è¿™ä¸ªæ•°ç»„çš„åç»­å¾ªç¯
          //     return true;
          //   }
          // })

          const index = this.list.findIndex((item) => {
            if (item.id == id) {
              return true;
            }
          });
          this.list.splice(index, 1);
        },
        search(keywords) { //æ ¹æ®å…³é”®å­—ï¼Œè¿›è¡Œæ•°æ®çš„æœç´¢
          // let newList = []
          // this.list.forEach(item => {
          //   if (item.name.indexOf(keywords) != -1){
          //     newList.push(item);
          //   }
          // })
          // return newList;

          // æ³¨æ„ ï¼š forEach some filter findIndex every éƒ½å±äºæ•°ç»„çš„æ–°æ–¹æ³•
          // éƒ½ä¼šå¯¹æ•°ç»„çš„æ¯ä¸€é¡¹ï¼Œè¿›è¡Œéå†ï¼Œæ‰§è¡Œç›¸å…³çš„æ“ä½œï¼›
          return this.list.filter(item => {
            // if(item.name.indexOf(keywords) != -1)
            // åœ¨ es6 ä¸­ï¼Œä¸ºå­—ç¬¦ä¸²æä¾›äº†ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œå«åš Stringã€‚prototypeã€‚includesï¼ˆâ€˜è¦åŒ…å«çš„å­—ç¬¦ä¸²â€™ï¼‰
            // å¦‚æœåŒ…å«è¿”å›trueï¼Œå¦åˆ™è¿”å›false
            if (item.name.includes(keywords)) {
              return item;
            }
          })
        }
      }
    });


    // å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªç§æœ‰çš„è¿‡æ»¤å™¨
    const vm2 = new Vue({
      el: ".app2",
      data: {
        dt: new Date()
      },
      methods: {},
      filters: { // å®šä¹‰ç§æœ‰è¿‡æ»¤å™¨ï¼Œ è¿‡æ»¤å™¨æœ‰ä¸¤ä¸ªæ¡ä»¶ï¼Œã€è¿‡æ»¤å™¨åç§° å’Œ å¤„ç†å‡½æ•°ã€‘
        // è¿‡æ»¤å™¨è°ƒç”¨çš„æ—¶å€™ï¼Œé‡‡ç”¨çš„æ˜¯å°±è¿‘åŸåˆ™ï¼Œå¦‚æœç§æœ‰è¿‡æ»¤å™¨å’Œå…¨å±€è¿‡æ»¤å™¨é‡åäº†ã€‚
        // ä¼˜å…ˆé‡‡ç”¨çš„æ˜¯ç§æœ‰è¿‡æ»¤å™¨
        dateFormat: function (dataStr, pattern = '') {
          const dt = new Date(dataStr);
          const y = dt.getFullYear();
          const m = (dt.getMonth() + 1).toString().padStart(2, '0');
          const d = dt.getDate().toString().padStart(2, '0');

          if (pattern.toLowerCase() === 'yyyy-mm-dd') {
            return ` ${y}-${m}-${d} `
          } else {
            const hh = dt.getHours().toString().padStart(2, '0');
            const mm = dt.getMinutes().toString().padStart(2, '0');
            const ss = dt.getSeconds().toString().padStart(2, '0');

            return ` ${y}-${m}-${d} ${hh}:${mm}:${ss} è¿™æ˜¯ç§æœ‰è´¢äº§`

          }
        }
      },
      directives: {
        'fontweight': {
          bind(el, binding) {
            el.style.fontWeight = binding.value;
          }
        },
        'fontsize': (el, binding) => {  //è¿™ä¸ªfunction ç­‰åŒäºæŠŠ ä»£ç å†™åˆ°äº†bind å’Œ updateä¸­å»
          el.style.fontSize = parseInt(binding.value) + "px";
        }
      }
    });




    // è¿‡æ»¤å™¨çš„å®šä¹‰è¯­æ³•
    // Vue.filter('è¿‡æ»¤å™¨çš„åç§°',function(){})

    // è¿‡æ»¤å™¨ä¸­çš„ funciton ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå·²ç»è¢«è§„å®šæ­»äº†ï¼Œæ°¸è¿œéƒ½æ˜¯ è¿‡æ»¤å™¨ç®¡é“ç¬¦å‰é¢ä¼ é€’è¿‡æ¥çš„æ•°æ®.
    // Vue.filter('è¿‡æ»¤å™¨çš„åç§°', function (data) { })
    // Vue ä¸æå€¡æ“ä½œDOm
    // document.getElementById('search').focus();
  </script>
</body>

</html>

<!-- è¿‡æ»¤å™¨è°ƒç”¨æ—¶å€™çš„æ ¼å¼ {{ name | è¿‡æ»¤å™¨çš„åç§° }} -->